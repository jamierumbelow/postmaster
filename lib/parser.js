// Generated by CoffeeScript 1.3.1

exports.Parser = (function() {
  var COMMANDS;

  Parser.name = 'Parser';

  function Parser() {}

  COMMANDS = ['HELO', 'EHLO', 'MAIL FROM', 'RCPT TO'];

  Parser.prototype.parse = function(string) {
    var args, command;
    command = '';
    COMMANDS.forEach(function(cmd) {
      if ((new RegExp("^" + cmd, 'm')).test(string)) {
        return command = cmd;
      }
    });
    if (this["parse" + (command.replace(' ', ''))] != null) {
      args = this["parse" + (command.replace(' ', ''))](string);
    }
    return {
      command: command,
      args: args
    };
  };

  Parser.prototype.parseHELO = function(string) {
    return {
      domain: string.match(/^(HELO|EHLO) (.*)$/m)[2]
    };
  };

  Parser.prototype.parseEHLO = function(string) {
    return this.parseHELO(string);
  };

  Parser.prototype.parseMAILFROM = function(string) {
    return {
      email: string.match(/^MAIL FROM:<(.*)>$/m)[1]
    };
  };

  Parser.prototype.parseRCPTTO = function(string) {
    return {
      email: string.match(/^RCPT TO:<(.*)>$/m)[1]
    };
  };

  return Parser;

})();
