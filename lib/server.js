// Generated by CoffeeScript 1.3.1
var net, version;

net = require('net');

version = require('../package.json').version;

exports.Server = (function() {

  Server.name = 'Server';

  function Server(next, host, port) {
    var _this = this;
    this.host = host != null ? host : 'localhost';
    this.port = port != null ? port : 5666;
    this.server = this.createServer();
    this.server.listen(this.port, this.host, function() {
      console.log("Postmaster reporting for duty on " + _this.host + ":" + _this.port);
      return next();
    });
  }

  Server.prototype.handler = function(socket) {
    return socket.write("220 " + this.host + " Postmaster " + version + "\r\n");
  };

  Server.prototype.createServer = function() {
    var _this = this;
    return net.createServer(function(socket) {
      return _this.handler(socket);
    });
  };

  Server.prototype.close = function() {
    return this.server.close();
  };

  return Server;

})();
